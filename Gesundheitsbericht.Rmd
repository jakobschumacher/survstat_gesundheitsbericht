---
title: "Gesundheitsbericht Survstat"
date: "7.10.2019"
output: html_document
params:
  Ort: "Reinickendorf"
---


```{r setup, include=FALSE, eval=TRUE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE)
library("knitr")
library("ISOweek")
library("lubridate")
library("pdftools")
suppressMessages(library("tidyverse"))
suppressMessages(setwd(here::here()))

Regionsvalue <- as.character(params$Ort)

source("R/readSurvstat.R")
source("R/readRegion.R")
source("R/plot.R")
data <- readRegion(Region = Regionsvalue)
```

```{r Grafiken, results='asis'}

krankheitsliste <- data %>% 
  filter(str_detect(Ort, as.character(params$Ort))) %>% 
  group_by(Krankheit) %>% summarise(summe = sum(Anzahl)) %>% 
  mutate(floor = ifelse(summe > 200, "3 months", "1 year")) %>%                                   
  filter(summe > 20) 

for (i in krankheitsliste$Krankheit) {
  floorvalue <- krankheitsliste %>% filter(Krankheit == i) %>% pull(floor)
  cat("\n")
  cat("\n")  
  cat("##", i, "\n")
  cat("\n")
  print(fallzahlPlot(i), floor = floorvalue)
  print(inzidenzPlot(i), floor = floorvalue)
}
```


