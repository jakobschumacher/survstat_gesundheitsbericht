scale_y_continuous(expand = c(0, 0))
)
print(
ggplot(data = df, aes(y = Inzidenz, x = Meldejahrmitwoche)) +
geom_line(stat = "identity", color = "steelblue") +
# stat_smooth(method = "gam", formula = y ~ s(x, k = 50), se = FALSE) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic() +
scale_y_continuous(expand = c(0, 0))
)
print(
ggplot(data = df, aes(y = Inzidenz, x = Meldejahrmitwoche)) +
geom_line(stat = "identity", color = "steelblue") +
# stat_smooth(method = "gam", formula = y ~ s(x, k = 50), se = FALSE) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic() +
expand_limits(y = 0)
)
# Inzidenz
df <- data %>% filter(Krankheit == i) %>%
mutate(Meldejahrmitwoche = floor_date(Meldejahrmitwoche, "1 year")) %>%
group_by(Meldejahrmitwoche, Ort) %>%
summarize(Inzidenz = mean(Inzidenz)) %>%
filter(Meldejahrmitwoche < as.Date("2020-01-01", origin = "1970-01-01"))
print(
ggplot(data = df, aes(y = Inzidenz, x = Meldejahrmitwoche)) +
geom_line(stat = "identity", color = "steelblue") +
# stat_smooth(method = "gam", formula = y ~ s(x, k = 50), se = FALSE) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic() +
expand_limits(y = 0)
)
df
print(
ggplot(data = df, aes(y = Inzidenz, x = Meldejahrmitwoche, color=Ort)) +
geom_line(stat = "identity", color = "steelblue") +
# stat_smooth(method = "gam", formula = y ~ s(x, k = 50), se = FALSE) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic() +
expand_limits(y = 0)
)
print(
ggplot(data = df, aes(y = Inzidenz, x = Meldejahrmitwoche, color = Ort)) +
geom_line(stat = "identity") +
# stat_smooth(method = "gam", formula = y ~ s(x, k = 50), se = FALSE) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic() +
expand_limits(y = 0)
)
print(
ggplot(data = df, aes(y = Inzidenz, x = Meldejahrmitwoche, color = Ort)) +
geom_line(stat = "identity") +
geom_point() +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic() +
expand_limits(y = 0)
)
# Filter the data and floor to the autodecision
df <- data %>% filter(Krankheit == i) %>%
group_by(Meldejahrmitwoche = floor_date(Meldejahrmitwoche, autodecision)) %>%
summarize(Anzahl = sum(Anzahl))
# Plot the graph
print(
ggplot(data = df, aes(y = Anzahl, x = Meldejahrmitwoche)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic()
)
# Plot the graph
print(
ggplot(data = df, aes(y = Anzahl, x = Meldejahrmitwoche)) +
geom_bar(stat = "identity", fill = "steelblue") +
facet_wrap(~Ort) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic()
)
# Filter the data and floor to the autodecision
df <- data %>% filter(Krankheit == i) %>%
mutate(Meldejahrmitwoche = floor_date(Meldejahrmitwoche, autodecision)) %>%
group_by(Meldejahrmitwoche, Ort) %>%
summarize(Anzahl = sum(Anzahl))
# Plot the graph
print(
ggplot(data = df, aes(y = Anzahl, x = Meldejahrmitwoche)) +
geom_bar(stat = "identity", fill = "steelblue") +
facet_wrap(~Ort) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic()
)
# Plot the graph
print(
ggplot(data = df, aes(y = Anzahl, x = Meldejahrmitwoche)) +
geom_bar(stat = "identity", fill = "steelblue") +
facet_wrap(~Ort, scales = "free") +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic()
)
# Plot the graph
print(
ggplot(data = df, aes(y = Anzahl, x = Meldejahrmitwoche)) +
geom_bar(stat = "identity", fill = "steelblue") +
facet_grid(~Ort, scales = "free") +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic()
)
# Plot the graph
print(
ggplot(data = df, aes(y = Anzahl, x = Meldejahrmitwoche)) +
geom_bar(stat = "identity", fill = "steelblue") +
facet_grid(~Ort, scales = "free", cols = 1) +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic()
)
# Plot the graph
print(
ggplot(data = df, aes(y = Anzahl, x = Meldejahrmitwoche)) +
geom_bar(stat = "identity", fill = "steelblue") +
facet_grid(Ort~., scales = "free") +
labs(title = title,
subtitle = subtitle,
caption = paste("Datenquelle:", Quellenangabe)) +
theme_classic()
)
render("Gesundheitsbericht.Rmd")
library("rmarkdown")
render("Gesundheitsbericht.Rmd")
list.files()
list.files(paste0("data", folder))
# List all files in the params folder
folder <- params$Ort
Sys.setenv(params = params$Ort)
# Read in the data
# List all files in the params folder
# folder <- paste0("data/", params$Ort)
#  a <- list.files(paste0("data/", folder))
# OrtInzidenz <- paste0("data/", folder, )
# data <- bind_rows(
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_NurReinickendorf.zip")  %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
#   )
# print("this is it")
# print(a)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort)
print(folder)
#  a <- list.files(paste0("data/", folder))
# OrtInzidenz <- paste0("data/", folder, )
# data <- bind_rows(
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_NurReinickendorf.zip")  %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
#   )
# print("this is it")
# print(a)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort)
print(folder)
#  a <- list.files(paste0("data/", folder))
# OrtInzidenz <- paste0("data/", folder, )
# data <- bind_rows(
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_NurReinickendorf.zip")  %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
#   )
# print("this is it")
# print(a)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort)
list.files(folder)
# OrtInzidenz <- paste0("data/", folder, )
# data <- bind_rows(
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_NurReinickendorf.zip")  %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
#   readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
#     left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
#   )
# print("this is it")
# print(a)
fileOrtInzidenz <- list.files(folder)[str_detect("Inzidenz", list.files(folder))]
fileOrtInzidenz
str_detect("Inzidenz", list.files(folder))
list.files(folder)
str_detect("Inzidenz", list.files(folder))
str_detect(list.files(folder), "Inzidenz")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtInzidenz
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtInzidenz
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
data <- bind_rows(
readSurvstat(paste0(folder,))  %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
# print("this is it")
# print(a)
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE)
library("here")
library("pdftools")
library("knitr")
library("ISOweek")
library("lubridate")
suppressMessages(library("tidyverse"))
suppressMessages(setwd(here::here()))
library(plotly)
readSurvstat <- function(file){
# Unzipping of the given file
unzip(file)
# Read in the Info.pdf that goes along with every Survstat-Zip-File
metadata <- pdf_text("Info.pdf") %>% str_replace_all("\n", "")
Datenstand <- str_match(metadata, "Abfragezeitpunkt (.*?) Sprache")[2]
Datenstand <- str_trim(Datenstand)
Spalte <- str_match(metadata, "Spaltenmerkmal (.*?) Anzeigeoptionen")[2]
Spalte <- str_replace_all(Spalte, "\\s|-", "")
Zeile <- str_match(metadata, "Zeilenmerkmal  (.*?) Spaltenmerkmal")[2]
Zeile <- str_replace_all(Zeile, "\\s|-", "")
Filter <- str_match(metadata, "Filtereinstellungen  (.*?) Zeilenmerkmal")[2]
Filter <- str_split(Filter, "\\s{5}", simplify = TRUE)
Filter <- str_subset(Filter, pattern = "[:alnum:]")
Filter <- str_trim(Filter)
Referenzdefinition <- ifelse(str_detect(paste(Filter, collapse = ""), "Referenzdefinition"), Filter[(str_which(Filter, "Referenzdefinition") + 1)], "Nein")
Ort <- ifelse(str_detect(paste(Filter, collapse = ""), "Bundesland"), Filter[(str_which(Filter, "Bundesland") + 1)], "Deutschland")
Anzeigeoptionen <- str_match(metadata, "Anzeigeoptionen (.*?) Datenstand zur")[2]
Anzeigeoptionen <- str_split(Anzeigeoptionen, "\\s{5}", simplify = TRUE)
Anzeigeoptionen <- str_subset(Anzeigeoptionen, pattern = "[:alnum:]")
Maßzahl <- Anzeigeoptionen[str_which(Anzeigeoptionen, "Inzidenz anstatt Anzahl anzeigen")]
Maßzahl <- ifelse(str_trim(str_split(Maßzahl, "\\:", simplify = TRUE)[[2]]) == "Nein", "Anzahl", "Inzidenz")
Quellenangabe <- str_split(metadata, "»|«", simplify = TRUE)[[2]]
# Read in the data file
data <- read.delim("Data.csv", sep = "\t", skip = 1, fileEncoding = "UTF-16LE", blank.lines.skip = TRUE, stringsAsFactors = FALSE)
# Remove empty line which gets introduced by reading the survstat format file
data <- data[-c(1),]
# Tidy up
data <- data %>%
gather(key = "column", value = "n", -X) %>%
mutate(n = ifelse(n == "", 0, n)) %>%
mutate(n = ifelse(is.na(n), 0, n)) %>%
mutate(n = str_replace(n, ",", ".")) %>%
mutate(n = as.numeric(n)) %>%
mutate(X = as.factor(X)) %>%
rename(!!Spalte := column) %>%
rename(!!Maßzahl := n) %>%
rename(!!Zeile := "X") %>%
mutate(Quellenangabe = Quellenangabe)
# Change Meldejahr mit Woche to date
if (str_detect(paste(names(data), collapse = ""), "Meldejahrmitwoche")) {
data <- data %>%
mutate(Meldejahrmitwoche = str_replace(Meldejahrmitwoche, ".K", "-")) %>%
mutate(Meldejahrmitwoche = str_replace(Meldejahrmitwoche, "X", "")) %>%
mutate(Meldejahrmitwoche = paste0(Meldejahrmitwoche, "-", 3)) %>%
mutate(Meldejahrmitwoche = ISOweek::ISOweek2date(Meldejahrmitwoche))
}
# Attach the information from the metadata on filter
data <- data %>%
mutate(Referenzdefinition =  Referenzdefinition) %>%
mutate(Ort =  Ort)
# Hand over the data object
data
}
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_NurReinickendorf.zip")),
readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
paste0(folder,fileOrtAnzahl)
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
paste0(folder,fileOrtAnzahl)
fileOrtAnzahl
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz)),
readSurvstat("data/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz)),
readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Anzahl")]
print(fileOrtAnzahl)
print(fileOrtInzidenz)
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz)),
readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
str_detect(list.files(folder), "Anzahl")
list.files(folder)
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
fileOrtAnzahl
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
print(fileOrtAnzahl)
print(fileOrtInzidenz)
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz)),
readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
print(fileOrtAnzahl)
print(fileOrtInzidenz)
data <- bind_rows(
readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz))
)
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
paste0(folder,fileOrtAnzahl)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
print(fileOrtAnzahl)
print(fileOrtInzidenz)
dataOrt <- readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz))
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
data <- bind_rows(dataOrt, dataDeutschland)
paste0(folder,fileOrtAnzahl)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
liste.files(folder)
dataOrt <- readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz))
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
data <- bind_rows(dataOrt, dataDeutschland)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
fileOrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
fileOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
list.files(folder)
dataOrt <- readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz))
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
data <- bind_rows(dataOrt, dataDeutschland)
OrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
eOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
fileOrtInzidenz <- paste0(folder, OrtInzidenz)
fileOrtInzidenz
fileOrtAnzahl <- paste0(folder, OrtAnzahl)
eOrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
OrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
fileOrtAnzahl <- paste0(folder, OrtAnzahl)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
OrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
OrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
fileOrtInzidenz <- paste0(folder, OrtInzidenz)
fileOrtAnzahl <- paste0(folder, OrtAnzahl)
list.files(folder)
dataOrt <- readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz))
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
data <- bind_rows(dataOrt, dataDeutschland)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
OrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
OrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
fileOrtInzidenz <- paste0(folder, OrtInzidenz)
fileOrtAnzahl <- paste0(folder, OrtAnzahl)
fileOrtAnzahl
fileOrtInzidenz
dataOrt <- readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz))
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
data <- bind_rows(dataOrt, dataDeutschland)
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
OrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
OrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
fileOrtInzidenz <- as.character(paste0(folder, OrtInzidenz))
fileOrtAnzahl <- as.character(paste0(folder, OrtAnzahl))
fileOrtAnzahl
fileOrtInzidenz
dataOrt <- readSurvstat(paste0(folder,fileOrtAnzahl))  %>%
left_join(paste0(folder,fileOrtInzidenz))
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"))
data <- bind_rows(dataOrt, dataDeutschland)
dataOrt <- readSurvstat(fileOrtAnzahl)  %>%   left_join(fileOrtInzidenz)
readSurvstat(fileOrtAnzahl)
dataOrt <- readSurvstat(fileOrtAnzahl)  %>%   left_join(readSurvstat(fileOrtInzidenz))
# Read in the data
# List all files in the params folder
folder <- paste0("data/", params$Ort, "/")
OrtInzidenz <- list.files(folder)[str_detect(list.files(folder), "Inzidenz")]
OrtAnzahl <- list.files(folder)[str_detect(list.files(folder), "Fallzahl")]
fileOrtInzidenz <- as.character(paste0(folder, OrtInzidenz))
fileOrtAnzahl <- as.character(paste0(folder, OrtAnzahl))
dataOrt <- readSurvstat(fileOrtAnzahl)  %>%
left_join(readSurvstat(fileOrtInzidenz), by = c("Krankheit", "Meldejahrmitwoche", "Quellenangabe", "Referenzdefinition", "Ort"))
dataDeutschland <- readSurvstat("data/Deutschland/FallzahlKrankheit_Jahrwoche_Deutschland.zip") %>%
left_join(readSurvstat("data/Deutschland/InzidenzKrankheit_Jahrwoche_Deutschland.zip"), by = c("Krankheit", "Meldejahrmitwoche", "Quellenangabe", "Referenzdefinition", "Ort"))
data <- bind_rows(dataOrt, dataDeutschland)
library("rmarkdown")
Ort <- "Reinickendorf"
render_report = function(Ort) {
rmarkdown::render(
"Gesundheitsbericht.Rmd", params = list(
Ort = Ort
),
output_file = paste0("Gesundheitsbericht-", Ort, ".html")
)
}
render_report("Reinickendorf")
library("rmarkdown")
Ort <- "Reinickendorf"
render_report = function(Ort) {
rmarkdown::render("Gesundheitsbericht.Rmd",
params = list(Ort = Ort),
output_file = paste0("Gesundheitsbericht-test.html"),
output_format = "html_document"
)
}
render_report("Reinickendorf")
